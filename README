# Sign Language Translation (Video → Vietnamese)

Lightweight toolkit để huấn luyện và đánh giá mô hình nhận diện ký hiệu tay (phrase recognition / video→text) trên tập dữ liệu video nhỏ. Hướng dẫn ngắn, phù hợp máy chỉ có CPU.

## Nội dung chính
- Mục tiêu: nhận diện video chứa 1 ký hiệu (từ/cụm từ) và dịch thành câu/phrase tiếng Việt.
- Mô hình chính: CNN per-frame + LSTM sequence + classifier — training script: [train_sign_language_distilbert.py](train_sign_language_distilbert.py).
- Công cụ hỗ trợ: chia dữ liệu, đồng bộ, nhân bản label:
  - Split train/valid: [split_train_valid_videos.py](split_train_valid_videos.py)
  - Sync valid từ train (copy/move khi cần): [sync_valid_with_train.py](sync_valid_with_train.py)
  - Tạo/kiểm tra label duplicates: [augment_labels.py](augment_labels.py)

## Cấu trúc thư mục (quan trọng)
- train/
  - vid/ — video training (.mp4/.avi/...)
  - labels/ — file .txt tương ứng (mỗi file chứa phrase)
- valid/
  - vid/, labels/ — validation set
- models/ — lưu checkpoints (ví dụ: [models/best_phrase_recognition.pt](models/best_phrase_recognition.pt))
- results/ — lịch sử training (ví dụ: [results/phrase_recognition_history.json](results/phrase_recognition_history.json))
- requirements.txt — dependencies ([requirements.txt](requirements.txt))

## Quick start (CPU)
1. Tạo virtualenv và kích hoạt.
2. Cài phụ thuộc:
   pip install -r requirements.txt
3. Chuẩn bị dữ liệu:
   - Đảm bảo mỗi video train/vid/X.mp4 có file label train/labels/X.txt chứa câu/phrase tiếng Việt tương ứng.
4. (Tùy chọn) Nếu cần split mới: chạy
   python split_train_valid_videos.py --ratio 0.8 --move
   hoặc dùng dry-run để kiểm tra.
5. Train:
   python train_sign_language_distilbert.py
   → Chọn option 1 trong menu. Xem và điều chỉnh cấu hình trong [train_sign_language_distilbert.py](train_sign_language_distilbert.py).
6. Test một video:
   Chọn option 2 trong [train_sign_language_distilbert.py](train_sign_language_distilbert.py) và nhập đường dẫn video.

## Lưu ý khi dữ liệu ít
- Dữ liệu hiện tại nhỏ → dễ overfit (xem [results/phrase_recognition_history.json](results/phrase_recognition_history.json)).
- Khuyến nghị:
  - Tăng data: quay thêm hoặc augmentation video.
  - Dùng [augment_labels.py](augment_labels.py) để nhân bản label (chỉ nhân nội dung label, không tạo video).
  - Dùng data augmentation runtime (flip, brightness, noise) — đã tích hợp trong dataset.
  - Giảm kích thước mô hình / số frames khi chạy trên CPU (tham số trong [train_sign_language_distilbert.py](train_sign_language_distilbert.py)).
  - Kiểm tra valid labels không chứa class chưa có trong train.

## Tips vận hành
- Trước mỗi lần split toàn bộ dữ liệu mới: gộp mọi file về `train/` rồi chạy `split_train_valid_videos.py` để tránh trùng lặp.
- Nếu muốn đồng bộ nhanh labels → videos: dùng [sync_valid_with_train.py](sync_valid_with_train.py).
- Lưu trữ checkpoints ở `models/` (đã .gitignore).

## Tham khảo nhanh các file chính
- Training & inference: [train_sign_language_distilbert.py](train_sign_language_distilbert.py)
- Split dữ liệu: [split_train_valid_videos.py](split_train_valid_videos.py)
- Sync valid labels: [sync_valid_with_train.py](sync_valid_with_train.py)
- Label augmentation/prune: [augment_labels.py](augment_labels.py)
- Dependencies: [requirements.txt](requirements.txt)
- Training history: [results/phrase_recognition_history.json](results/phrase_recognition_history.json)
- Checkpoint mẫu: [models/best_phrase_recognition.pt](models/best_phrase_recognition.pt)

Nếu muốn tôi cập nhật README bằng tiếng Anh hoặc thêm phần hướng dẫn chi tiết cho CPU-only training, tôi sẽ chỉnh file trên.