# Sign Language Translation - YOLOv8 Segmentation

Há»‡ thá»‘ng nháº­n diá»‡n ngÃ´n ngá»¯ kÃ½ hiá»‡u (ASL - American Sign Language) sá»­ dá»¥ng **YOLOv8 Segmentation** vÃ  Deep Learning.

## ğŸ“‹ MÃ´ táº£

Project nÃ y sá»­ dá»¥ng **YOLOv8 Segmentation** Ä‘á»ƒ phÃ¡t hiá»‡n vÃ  nháº­n diá»‡n cÃ¡c kÃ½ hiá»‡u ngÃ´n ngá»¯ tay ASL tá»« áº£nh. Há»‡ thá»‘ng cÃ³ thá»ƒ:

- âœ… Huáº¥n luyá»‡n YOLOv8-seg model tá»« dataset segmentation tÃ¹y chá»‰nh
- âœ… PhÃ¡t hiá»‡n vÃ  nháº­n diá»‡n 22 kÃ½ tá»± ASL (A-Z trá»« F vÃ  J)
- âœ… Dá»± Ä‘oÃ¡n vá»›i polygon masks (segmentation) thay vÃ¬ chá»‰ bounding boxes
- âœ… Visualize dataset vá»›i cáº£ cáº¥u trÃºc flat vÃ  per-class
- âœ… Há»— trá»£ training trÃªn CPU vÃ  GPU

## ğŸ¯ Äiá»ƒm ná»•i báº­t

### YOLOv8 Segmentation vs Detection

| Feature | Detection (bbox) | **Segmentation (polygon)** âœ“ |
|---------|------------------|-------------------------------|
| Output | Bounding box | Polygon mask |
| Äá»™ chÃ­nh xÃ¡c | Trung bÃ¬nh | **Cao hÆ¡n** |
| Label format | `class x y w h` | **`class x1 y1 x2 y2 ...`** |
| Use case | Object localization | **Precise shape detection** |

**Dataset hiá»‡n táº¡i** sá»­ dá»¥ng **polygon labels** (segmentation format), phÃ¹ há»£p vá»›i YOLOv8-seg.

## ğŸ—‚ï¸ Cáº¥u trÃºc thÆ° má»¥c

```
sign-language-translation/
â”œâ”€â”€ .gitignore                      # Loáº¡i trá»« file khÃ´ng cáº§n thiáº¿t
â”œâ”€â”€ requirements.txt                # ThÆ° viá»‡n Python
â”œâ”€â”€ sign_language_translation.py    # â­ File chÃ­nh (YOLOv8-seg)
â”œâ”€â”€ README.md                       # File nÃ y
â”œâ”€â”€ dataset/                        # âš ï¸ KHÃ”NG Ä‘Æ°á»£c push lÃªn GitHub
â”‚   â”œâ”€â”€ train/
â”‚   â”‚   â”œâ”€â”€ images/                # áº¢nh training
â”‚   â”‚   â””â”€â”€ labels/                # â­ SEGMENTATION labels (.txt)
â”‚   â”‚       â””â”€â”€ *.txt              # Format: class x1 y1 x2 y2 ...
â”‚   â””â”€â”€ val/
â”‚       â”œâ”€â”€ images/                # áº¢nh validation
â”‚       â””â”€â”€ labels/                # Labels validation
â”œâ”€â”€ models/                         # âš ï¸ Models Ä‘Ã£ train (khÃ´ng push)
â”‚   â””â”€â”€ sign_language_model/
â”‚       â””â”€â”€ weights/
â”‚           â””â”€â”€ best.pt            # YOLOv8-seg model tá»‘t nháº¥t
â””â”€â”€ train/                          # Config files
    â””â”€â”€ dataset.yaml               # YOLO dataset config
```

## ğŸš€ CÃ i Ä‘áº·t

### YÃªu cáº§u há»‡ thá»‘ng

- **Python**: 3.10 hoáº·c 3.11 (âš ï¸ **KHÃ”NG** dÃ¹ng Python 3.13)
- **OS**: Windows 10/11, Linux, hoáº·c macOS
- **Hardware**: 
  - GPU NVIDIA (khuyáº¿n nghá»‹, tÄƒng tá»‘c 10-50x)
  - CPU (cÃ³ thá»ƒ dÃ¹ng nhÆ°ng cháº­m hÆ¡n)

### BÆ°á»›c 1: Clone repository

```bash
git clone https://github.com/your-username/sign-language-translation.git
cd sign-language-translation
```

### BÆ°á»›c 2: Táº¡o mÃ´i trÆ°á»ng áº£o

**Windows:**
```bash
python -m venv venv
venv\Scripts\activate
```

**Linux/macOS:**
```bash
python3 -m venv venv
source venv/bin/activate
```

### BÆ°á»›c 3: CÃ i Ä‘áº·t thÆ° viá»‡n

```bash
# NÃ¢ng cáº¥p pip
python -m pip install --upgrade pip setuptools wheel

# CÃ i Ä‘áº·t dependencies (bao gá»“m ultralytics YOLOv8)
pip install -r requirements.txt
```

### BÆ°á»›c 4: Chuáº©n bá»‹ dataset

#### ğŸ“¥ Táº£i dataset ASL (Segmentation format)

**Nguá»“n khuyáº¿n nghá»‹:**
- [Roboflow ASL Segmentation](https://universe.roboflow.com/david-lee-d0rhs/american-sign-language-letters) â­
- Xuáº¥t á»Ÿ Ä‘á»‹nh dáº¡ng **YOLOv8 Segmentation**

**âš ï¸ QUAN TRá»ŒNG:** Dataset pháº£i cÃ³ **segmentation labels** (polygon format):

```
# VÃ­ dá»¥ file label: A_0.txt
0 0.794 0.059 0.736 0.125 0.714 0.126 ... (nhiá»u cáº·p x,y táº¡o polygon)
```

**KHÃ”NG pháº£i** detection format (chá»‰ cÃ³ 5 sá»‘):
```
0 0.5 0.5 0.3 0.4  # âŒ SAI - Ä‘Ã¢y lÃ  detection format
```

#### ğŸ“ Tá»• chá»©c dataset

Äáº·t dataset theo cáº¥u trÃºc sau:

```
dataset/
â”œâ”€â”€ train/
â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â”œâ”€â”€ A_0.jpg
â”‚   â”‚   â”œâ”€â”€ A_1.jpg
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ labels/
â”‚       â”œâ”€â”€ A_0.txt       # Segmentation labels
â”‚       â”œâ”€â”€ A_1.txt
â”‚       â””â”€â”€ ...
â””â”€â”€ val/                  # Validation data (tÃ¹y chá»n)
    â”œâ”€â”€ images/
    â””â”€â”€ labels/
```

**LÆ°u Ã½:**
- Má»—i áº£nh `.jpg` pháº£i cÃ³ file label `.txt` tÆ°Æ¡ng á»©ng
- File label chá»©a polygon points (nhiá»u cáº·p x,y) thay vÃ¬ bbox (x,y,w,h)

## ğŸ¯ Sá»­ dá»¥ng

### Cháº¡y chÆ°Æ¡ng trÃ¬nh chÃ­nh

```bash
python sign_language_translation.py
```

Menu sáº½ hiá»ƒn thá»‹:
```
ğŸ¤– SIGN LANGUAGE TRANSLATION - YOLOv8 SEGMENTATION
============================================================
ğŸ“ Base Directory: E:\...\sign-language-translation
ğŸ“ Dataset Directory: E:\...\dataset
ğŸ“ Models Directory: E:\...\models
ğŸ”§ Model: YOLOv8 Segmentation (yolov8n-seg.pt)
============================================================

Chá»n chá»©c nÄƒng:
1. Táº¡o file dataset.yaml
2. Visualize dataset
3. Train model (YOLOv8-seg)
4. Predict trÃªn áº£nh
0. ThoÃ¡t
```

### 1ï¸âƒ£ Táº¡o file cáº¥u hÃ¬nh dataset

```bash
# Option 1: Qua menu (chá»n 1)
python sign_language_translation.py

# Option 2: Gá»i trá»±c tiáº¿p
python -c "from sign_language_translation import create_dataset_yaml; create_dataset_yaml(use_all=True)"
```

Tham sá»‘:
- `use_all=True`: DÃ¹ng toÃ n bá»™ train data cho cáº£ training vÃ  validation
- `use_all=False`: DÃ¹ng riÃªng val/ cho validation (khuyáº¿n nghá»‹ náº¿u cÃ³ val data)

### 2ï¸âƒ£ Xem máº«u dataset

```bash
# Visualize dataset Ä‘á»ƒ kiá»ƒm tra
python -c "from sign_language_translation import visualize_dataset; visualize_dataset()"
```

### 3ï¸âƒ£ Huáº¥n luyá»‡n model YOLOv8-seg

```bash
# Training cÆ¡ báº£n
python -c "from sign_language_translation import train_model; train_model(epochs=50, batch=16, use_all=True)"
```

**Tham sá»‘ training:**

| Tham sá»‘ | Máº·c Ä‘á»‹nh | MÃ´ táº£ |
|---------|----------|-------|
| `epochs` | 50 | Sá»‘ láº§n duyá»‡t toÃ n bá»™ dataset |
| `batch` | 16 | Sá»‘ áº£nh xá»­ lÃ½ cÃ¹ng lÃºc (giáº£m náº¿u thiáº¿u RAM/VRAM) |
| `imgsz` | 640 | KÃ­ch thÆ°á»›c áº£nh input (640, 800, 1024...) |
| `model_name` | `'yolov8n-seg.pt'` | Pretrained model (n/s/m/l/x) |
| `use_all` | False | DÃ¹ng toÃ n bá»™ data cho training |

**VÃ­ dá»¥ training nÃ¢ng cao:**

```python
from sign_language_translation import train_model

# Training 100 epochs vá»›i batch size 8 (phÃ¹ há»£p GPU nhá»)
model, results = train_model(
    epochs=100,
    batch=8,
    imgsz=800,
    model_name='yolov8s-seg.pt',  # Model lá»›n hÆ¡n = chÃ­nh xÃ¡c hÆ¡n
    use_all=True
)
```

**LÆ°u Ã½:**
- GPU khuyáº¿n nghá»‹: batch=16-32
- CPU hoáº·c GPU nhá»: batch=4-8
- Model sau training lÆ°u táº¡i: `models/sign_language_model/weights/best.pt`

### 4ï¸âƒ£ Dá»± Ä‘oÃ¡n trÃªn áº£nh má»›i

```bash
# Qua menu (chá»n 4)
python sign_language_translation.py

# Hoáº·c gá»i trá»±c tiáº¿p
python -c "
from ultralytics import YOLO
from sign_language_translation import predict_image

model = YOLO('models/sign_language_model/weights/best.pt')
predict_image(model, 'path/to/test_image.jpg')
"
```

## ğŸ“Š Dataset Classes

Dataset bao gá»“m **22 class** tÆ°Æ¡ng á»©ng vá»›i cÃ¡c kÃ½ tá»± ASL:

```
A, B, C, D, E, G, H, I, K, L, M, N, O, P, Q, R, S, T, U, V, X, Y
```

**LÆ°u Ã½:** KhÃ´ng bao gá»“m F vÃ  J vÃ¬ yÃªu cáº§u chuyá»ƒn Ä‘á»™ng (Ä‘á»™ng tÃ¡c)

## ğŸ”§ Troubleshooting

### âŒ Lá»—i: "No module named 'ultralytics'"

```bash
pip install ultralytics
```

### âŒ Lá»—i: "CUDA out of memory"

Giáº£m batch size:
```python
train_model(batch=4)  # Thay vÃ¬ 16
```

### âŒ Warning: "Validation path khÃ´ng tá»“n táº¡i"

Chá»n `use_all=True` khi training:
```python
train_model(use_all=True)
```

### âŒ Lá»—i: "Labels wrong format"

Kiá»ƒm tra format label:
```bash
# ÄÃºng (segmentation): nhiá»u cáº·p x,y
0 0.794 0.059 0.736 0.125 0.714 0.126 ...

# Sai (detection): chá»‰ 5 sá»‘
0 0.5 0.5 0.3 0.4  # âŒ Cáº§n convert sang segmentation
```

## ğŸ“¦ Quáº£n lÃ½ Dataset vÃ  Model

âš ï¸ **Dataset vÃ  model KHÃ”NG Ä‘Æ°á»£c push lÃªn GitHub** (xem [.gitignore](.gitignore))

Khi clone repo, báº¡n cáº§n:
1. Táº£i dataset riÃªng tá»« nguá»“n cÃ´ng khai (xem [BÆ°á»›c 4](#bÆ°á»›c-4-chuáº©n-bá»‹-dataset))
2. Train model cá»§a riÃªng báº¡n (xem [Pháº§n 3](#3ï¸âƒ£-huáº¥n-luyá»‡n-model-yolov8-seg))

**Chia sáº» dataset/model qua:**
- Google Drive / Dropbox
- Kaggle Datasets
- Hugging Face Model Hub

## ğŸ¤ ÄÃ³ng gÃ³p

1. Fork repo
2. Táº¡o branch má»›i (`git checkout -b feature/AmazingFeature`)
3. Commit thay Ä‘á»•i (`git commit -m 'Add YOLOv8-seg support'`)
4. Push lÃªn branch (`git push origin feature/AmazingFeature`)
5. Táº¡o Pull Request

## ğŸ“„ License

MIT License - Project chá»‰ dÃ¹ng cho má»¥c Ä‘Ã­ch há»c táº­p vÃ  nghiÃªn cá»©u.

## ğŸ“š TÃ i liá»‡u tham kháº£o

- [Ultralytics YOLOv8 Docs](https://docs.ultralytics.com/)
- [YOLOv8 Segmentation Guide](https://docs.ultralytics.com/tasks/segment/)
- [Roboflow Universe - ASL Dataset](https://universe.roboflow.com/)

---

**âš ï¸ LÆ°u Ã½ quan trá»ng:**
- Project nÃ y sá»­ dá»¥ng **YOLOv8 Segmentation** (khÃ´ng pháº£i Detection)
- Labels pháº£i á»Ÿ format **polygon** (nhiá»u cáº·p x,y), khÃ´ng pháº£i bbox (x,y,w,h)
- Pretrained model máº·c Ä‘á»‹nh: `yolov8n-seg.pt` (segmentation)